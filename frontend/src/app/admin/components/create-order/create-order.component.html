<div class="fade-in">
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-1">
                <i class="fas fa-plus-circle me-2"></i>Create New Order
            </h2>
            <p class="text-muted mb-0">Add a new customer order to the system</p>
        </div>
        <button class="btn btn-outline-primary" (click)="viewAllOrders()">
            <i class="fas fa-list me-2"></i>View All Orders
        </button>
    </div>

    <!-- Success Message with Tracking ID -->
    <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show" role="alert">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <i class="fas fa-check-circle me-2"></i>
                {{ successMessage }}
            </div>
            <div>
                <button class="btn btn-sm btn-outline-success me-2" (click)="copyToClipboard(generatedTrackingId)">
                    <i class="fas fa-copy me-1"></i>Copy Tracking ID
                </button>
                <button class="btn btn-sm btn-success" [routerLink]="['/customer/details', generatedTrackingId]">
                    <i class="fas fa-eye me-1"></i>View Order
                </button>
            </div>
        </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-triangle me-2"></i>
        {{ errorMessage }}
        <button type="button" class="btn-close" (click)="errorMessage = ''"></button>
    </div>

    <!-- Order Form -->
    <div class="row">
        <div class="col-lg-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-user-circle me-2"></i>Customer Information
                    </h5>
                </div>
                <div class="card-body">
                    <form [formGroup]="orderForm" (ngSubmit)="onSubmit()">
                        <!-- Customer Details -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="customerName" class="form-label">
                                    <i class="fas fa-user me-2"></i>Full Name *
                                </label>
                                <input type="text" class="form-control" id="customerName" formControlName="customerName"
                                    placeholder="Enter customer's full name" [ngClass]="{
                    'is-invalid': customerNameControl?.invalid && (customerNameControl?.dirty || customerNameControl?.touched),
                    'is-valid': customerNameControl?.valid && customerNameControl?.dirty
                  }">
                                <div *ngIf="customerNameControl?.invalid && (customerNameControl?.dirty || customerNameControl?.touched)"
                                    class="invalid-feedback">
                                    <div *ngIf="customerNameControl?.errors?.['required']">
                                        Customer name is required.
                                    </div>
                                    <div *ngIf="customerNameControl?.errors?.['minlength']">
                                        Name must be at least 2 characters.
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <label for="customerEmail" class="form-label">
                                    <i class="fas fa-envelope me-2"></i>Email Address *
                                </label>
                                <input type="email" class="form-control" id="customerEmail"
                                    formControlName="customerEmail" placeholder="customer@example.com" [ngClass]="{
                    'is-invalid': customerEmailControl?.invalid && (customerEmailControl?.dirty || customerEmailControl?.touched),
                    'is-valid': customerEmailControl?.valid && customerEmailControl?.dirty
                  }">
                                <div *ngIf="customerEmailControl?.invalid && (customerEmailControl?.dirty || customerEmailControl?.touched)"
                                    class="invalid-feedback">
                                    <div *ngIf="customerEmailControl?.errors?.['required']">
                                        Email address is required.
                                    </div>
                                    <div *ngIf="customerEmailControl?.errors?.['email']">
                                        Please enter a valid email address.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="customerPhone" class="form-label">
                                    <i class="fas fa-phone me-2"></i>Phone Number *
                                </label>
                                <input type="tel" class="form-control" id="customerPhone"
                                    formControlName="customerPhone" placeholder="+1234567890" [ngClass]="{
                    'is-invalid': customerPhoneControl?.invalid && (customerPhoneControl?.dirty || customerPhoneControl?.touched),
                    'is-valid': customerPhoneControl?.valid && customerPhoneControl?.dirty
                  }">
                                <div *ngIf="customerPhoneControl?.invalid && (customerPhoneControl?.dirty || customerPhoneControl?.touched)"
                                    class="invalid-feedback">
                                    <div *ngIf="customerPhoneControl?.errors?.['required']">
                                        Phone number is required.
                                    </div>
                                    <div *ngIf="customerPhoneControl?.errors?.['pattern']">
                                        Please enter a valid phone number.
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <label for="shippingAddress" class="form-label">
                                    <i class="fas fa-map-marker-alt me-2"></i>Shipping Address *
                                </label>
                                <textarea class="form-control" id="shippingAddress" formControlName="shippingAddress"
                                    placeholder="Full shipping address including city, state, and zip code" rows="2"
                                    [ngClass]="{
                    'is-invalid': shippingAddressControl?.invalid && (shippingAddressControl?.dirty || shippingAddressControl?.touched),
                    'is-valid': shippingAddressControl?.valid && shippingAddressControl?.dirty
                  }"></textarea>
                                <div *ngIf="shippingAddressControl?.invalid && (shippingAddressControl?.dirty || shippingAddressControl?.touched)"
                                    class="invalid-feedback">
                                    <div *ngIf="shippingAddressControl?.errors?.['required']">
                                        Shipping address is required.
                                    </div>
                                    <div *ngIf="shippingAddressControl?.errors?.['minlength']">
                                        Address must be at least 10 characters.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label for="companyName" class="form-label">
                                    <i class="fas fa-building me-2"></i>Company Name
                                </label>
                                <input type="text" class="form-control" id="companyName" formControlName="companyName"
                                    placeholder="Enter company name (optional)">
                            </div>

                            <div class="col-md-6">
                                <label for="companyAddress" class="form-label">
                                    <i class="fas fa-map-marked-alt me-2"></i>Company Address
                                </label>
                                <textarea class="form-control" id="companyAddress" formControlName="companyAddress"
                                    placeholder="Enter company address (optional)" rows="1"></textarea>
                            </div>
                        </div>

                        <!-- Order Details -->
                        <div class="card mb-4">
                            <div class="card-header bg-primary text-white">
                                <h6 class="mb-0">
                                    <i class="fas fa-box me-2"></i>Order Details
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="itemName" class="form-label">
                                            <i class="fas fa-tag me-2"></i>Item Name *
                                        </label>
                                        <input type="text" class="form-control" id="itemName" formControlName="itemName"
                                            placeholder="e.g., Laptop, Smartphone, etc." [ngClass]="{
                        'is-invalid': itemNameControl?.invalid && (itemNameControl?.dirty || itemNameControl?.touched),
                        'is-valid': itemNameControl?.valid && itemNameControl?.dirty
                      }">
                                        <div *ngIf="itemNameControl?.invalid && (itemNameControl?.dirty || itemNameControl?.touched)"
                                            class="invalid-feedback">
                                            <div *ngIf="itemNameControl?.errors?.['required']">
                                                Item name is required.
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <label for="quantity" class="form-label">
                                            <i class="fas fa-hashtag me-2"></i>Quantity *
                                        </label>
                                        <input type="number" class="form-control" id="quantity"
                                            formControlName="quantity" min="1" max="100" [ngClass]="{
                        'is-invalid': quantityControl?.invalid && (quantityControl?.dirty || quantityControl?.touched),
                        'is-valid': quantityControl?.valid && quantityControl?.dirty
                      }">
                                        <div *ngIf="quantityControl?.invalid && (quantityControl?.dirty || quantityControl?.touched)"
                                            class="invalid-feedback">
                                            <div *ngIf="quantityControl?.errors?.['required']">
                                                Quantity is required.
                                            </div>
                                            <div *ngIf="quantityControl?.errors?.['min']">
                                                Minimum quantity is 1.
                                            </div>
                                            <div *ngIf="quantityControl?.errors?.['max']">
                                                Maximum quantity is 100.
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row g-3 mt-3">
                                    <div class="col-md-6">
                                        <label for="itemDescription" class="form-label">
                                            <i class="fas fa-align-left me-2"></i>Item Description
                                        </label>
                                        <textarea class="form-control" id="itemDescription"
                                            formControlName="itemDescription"
                                            placeholder="Optional description of the item" rows="2"></textarea>
                                    </div>

                                    <div class="col-md-6">
                                        <label for="totalAmount" class="form-label">
                                            <i class="fas fa-dollar-sign me-2"></i>Total Amount *
                                        </label>
                                        <div class="input-group">
                                            <span class="input-group-text">$</span>
                                            <input type="number" class="form-control" id="totalAmount"
                                                formControlName="totalAmount" placeholder="0.00" step="0.01" min="0.01"
                                                [ngClass]="{
                          'is-invalid': totalAmountControl?.invalid && (totalAmountControl?.dirty || totalAmountControl?.touched),
                          'is-valid': totalAmountControl?.valid && totalAmountControl?.dirty
                        }">
                                        </div>
                                        <div *ngIf="totalAmountControl?.invalid && (totalAmountControl?.dirty || totalAmountControl?.touched)"
                                            class="invalid-feedback">
                                            <div *ngIf="totalAmountControl?.errors?.['required']">
                                                Total amount is required.
                                            </div>
                                            <div *ngIf="totalAmountControl?.errors?.['min']">
                                                Amount must be greater than 0.
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-3">
                                    <label for="notes" class="form-label">
                                        <i class="fas fa-sticky-note me-2"></i>Additional Notes
                                    </label>
                                    <textarea class="form-control" id="notes" formControlName="notes"
                                        placeholder="Any special instructions or notes" rows="3"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-outline-secondary" (click)="createAnotherOrder()"
                                *ngIf="successMessage">
                                <i class="fas fa-plus me-2"></i>Create Another Order
                            </button>
                            <div class="ms-auto">
                                <button type="button" class="btn btn-outline-secondary me-2" (click)="viewAllOrders()">
                                    Cancel
                                </button>
                                <button type="submit" class="btn btn-primary"
                                    [disabled]="orderForm.invalid || isLoading">
                                    <span *ngIf="!isLoading">
                                        <i class="fas fa-save me-2"></i>Create Order
                                    </span>
                                    <span *ngIf="isLoading">
                                        <i class="fas fa-spinner fa-spin me-2"></i>Creating...
                                    </span>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Instructions Sidebar -->
        <div class="col-lg-4">
            <div class="card shadow">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-info-circle me-2"></i>Instructions
                    </h5>
                </div>
                <div class="card-body">
                    <div class="mb-4">
                        <h6><i class="fas fa-asterisk me-2 text-danger"></i>Required Fields</h6>
                        <p class="small text-muted">
                            Fields marked with * are required. Make sure all required information is provided.
                        </p>
                    </div>

                    <div class="mb-4">
                        <h6><i class="fas fa-id-card me-2 text-primary"></i>Customer Information</h6>
                        <p class="small text-muted">
                            Enter accurate customer details for shipping and communication.
                        </p>
                    </div>

                    <div class="mb-4">
                        <h6><i class="fas fa-box-open me-2 text-success"></i>Order Details</h6>
                        <p class="small text-muted">
                            Provide clear item description and accurate pricing information.
                        </p>
                    </div>

                    <div class="mb-4">
                        <h6><i class="fas fa-barcode me-2 text-warning"></i>Tracking ID</h6>
                        <p class="small text-muted">
                            A unique tracking ID will be automatically generated upon order creation.
                        </p>
                    </div>

                    <div class="alert alert-light border">
                        <h6><i class="fas fa-lightbulb me-2"></i>Pro Tip</h6>
                        <p class="small mb-0">
                            Copy the tracking ID and share it with the customer immediately after order creation.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="card shadow mt-4">
                <div class="card-header bg-light">
                    <h6 class="mb-0">
                        <i class="fas fa-chart-line me-2"></i>Quick Stats
                    </h6>
                </div>
                <div class="card-body">
                    <div class="text-center">
                        <div class="display-6 text-primary mb-2">
                            <i class="fas fa-box"></i>
                        </div>
                        <h5>New Order</h5>
                        <p class="small text-muted mb-0">
                            Fill out the form to create a new customer order. The system will automatically generate a
                            tracking ID.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>